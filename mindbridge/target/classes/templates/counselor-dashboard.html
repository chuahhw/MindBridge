<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Counselor Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { font-family: Arial, sans-serif; background: #f8f9fa; padding: 0; margin: 0; }
        .navbar { background:#128635; padding:15px 0; border-bottom:none; }
        .navbar-container { max-width:1200px; margin:auto; padding:0 20px; display:flex; justify-content:space-between; align-items:center; }
        .navbar-brand { font-weight:600; font-size:24px; color:#fff; text-decoration:none; }
        .user-section { display:flex; align-items:center; gap:15px; }
        .username { color:#fff; font-size:14px; font-weight:500; }
        .logout-btn { background:#fff; color:#128635; padding:8px 16px; border-radius:4px; font-weight:600; border:none; cursor:pointer; }
        .logout-btn:hover { background:#f8f9fa; }

        .menu-tabs { background:#fff; border-bottom:1px solid #dee2e6; padding:15px 0; }
        .tabs-container { max-width:1200px; margin:auto; padding:0 20px; }
        .nav-tabs { display:flex; list-style:none; padding:0; margin:0; }
        .nav-tabs .nav-link { padding:15px 20px; color:#495057; font-weight:500; font-size:14px; text-decoration:none; border:none; }
        .nav-tabs .nav-link.active { color:#128635; border-bottom:3px solid #128635; font-weight:600; }
        .nav-tabs .nav-link:hover { color:#128635; background:#f8f9fa; }

        .metric-card { background: #fff; border-radius: 10px; padding: 20px; text-align: left; box-shadow: 0 2px 6px rgba(0,0,0,0.05); }
        .metric-title { font-size: 14px; color: #666; font-weight: 500; }
        .metric-number { font-size: 28px; font-weight: 700; margin-top: 8px; }
        .metric-pill { display: inline-block; padding: 4px 10px; border-radius: 6px; font-weight: bold; color: #333; }
        .pill-yellow { background: #fff3cd; }
        .pill-blue { background: #cfe2ff; }
        .pill-green { background: #d1e7dd; }

        .schedule-card { background: #fff; border-radius: 10px; padding: 20px; margin-top: 25px; box-shadow: 0 2px 6px rgba(0,0,0,0.05); }
        .schedule-item { background: #e8f0fe; padding: 15px 20px; border-left: 5px solid #4a90e2; border-radius: 8px; margin-bottom: 12px; }
        .schedule-name { font-weight: 600; font-size: 16px; }
        .schedule-type { font-size: 14px; color: #555; }

        .pending-box { background: #fff8d6; border-left: 5px solid #e0b800; padding: 20px; margin-top: 25px; border-radius: 8px; }
    </style>
</head>

<body>

<div th:replace="~{fragments/counselor-header :: header}"></div>
<div th:replace="~{fragments/counselor-menu :: menu('dashboard')}"></div>

<div class="container mt-4">
    <h3 class="mb-4">Dashboard</h3>

    <div class="row g-4">
        <div class="col-md-4">
            <div class="metric-card">
                <div class="metric-title">Pending Requests</div>
                <div class="metric-number"><span class="metric-pill pill-yellow" th:text="${pendingCount}">0</span></div>
            </div>
        </div>

        <div class="col-md-4">
            <div class="metric-card">
                <div class="metric-title">Today's Sessions</div>
                <div class="metric-number"><span class="metric-pill pill-blue" th:text="${todaySessions}">0</span></div>
            </div>
        </div>

        <div class="col-md-4">
            <div class="metric-card">
                <div class="metric-title">This Week</div>
                <div class="metric-number"><span class="metric-pill pill-green" th:text="${weekTotal}">0</span></div>
            </div>
        </div>
    </div>

    <!-- TODAY'S SCHEDULE -->
    <div class="schedule-card">
        <h5 class="mb-3">Today's Schedule</h5>

        <div th:if="${todayList != null and !todayList.isEmpty()}">
            <div th:each="ap : ${todayList}" class="schedule-item">
                <div class="schedule-name">
                    <span th:text="${ap.student.fullName}">Student</span> -
                    <span th:text="${#temporals.format(ap.time, 'hh:mm a')}">00:00 PM</span>
                </div>
                <div class="schedule-type">
                    <span th:text="${ap.type}">Video Call</span> â€¢
                    <span th:text="${ap.notes}">Notes</span>
                </div>
            </div>
        </div>

        <p th:if="${todayList == null or todayList.isEmpty()}" class="text-muted">No sessions scheduled for today.</p>
    </div>

    <!-- PENDING REQUESTS -->
    <div class="pending-box">
        <h6 class="fw-bold">Pending Requests</h6>
        <p>You have <strong th:text="${pendingCount}">0</strong> appointment requests waiting for approval.</p>
        <a th:href="@{/counselor/appointments}" class="btn btn-warning">View Requests</a>
    </div>

</div>

</body>
</html>

